<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous" />
    <title>Fruit Classifier</title>
    <link rel="stylesheet" href="../static/css/style.css" />
  </head>
  <body style="background-color: #393e46">
    <!-- Main -->
    <div class="container my-5">
      <div class="card mx-auto" style="max-width: 800px">
        <div class="card-body">
          <h3 class="text-center">Ten Fruits Classification</h3>
          <p id="created" class="text-center">
            Created by: Mahsa Nurfarhan Hidayat
          </p>
          <hr />
          <div class="row mb-5 mt-5">
            <div class="col">
              <div class="container">
                <form id="upload-form">
                  <label for="file-input" class="form-label"
                    >Masukkan Gambar :</label
                  >
                  <input
                    type="file"
                    id="file-input"
                    accept="image/*"
                    class="form-control mb-2" />
                  <div class="box">
                    <button type="button" onclick="predict()" class="button">
                      <span>Predict</span>
                    </button>
                  </div>
                </form>
              </div>
            </div>
            <div class="col">
              <div class="container">
                <div class="card">
                  <div class="card-body">
                    <div class="text-center" id="result"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="container">
            <div class="card mx-auto" style="max-width: 800px">
              <div class="card-body">
                <div class="container">
                  <p><b>Note :</b></p>
                  <p>
                    Karena keterbatasan dari penelitian ini, model ini hanya
                    bisa mengklasifikasi 10(sepuluh) jenis buah saja, yaitu :
                  </p>
                  <div class="row">
                    <div class="col">
                      <ul>
                        <li>Apple</li>
                        <li>Avocado</li>
                      </ul>
                    </div>
                    <div class="col">
                      <ul>
                        <li>Banana</li>
                        <li>Grape</li>
                      </ul>
                    </div>
                    <div class="col">
                      <ul>
                        <li>Guava</li>
                        <li>Mango</li>
                      </ul>
                    </div>
                    <div class="col">
                      <ul>
                        <li>Orange</li>
                        <li>Rambutan</li>
                      </ul>
                    </div>
                    <div class="col">
                      <ul>
                        <li>Salak</li>
                        <li>Watermelon</li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Main -->

    <!-- Main 2 -->
    <div class="container my-5">
      <div class="card mx-auto" style="max-width: 800px">
        <div class="card-body">
          <h3 class="text-center">Report</h3>
          <p id="created" class="text-center">
            Created by: Mahsa Nurfarhan Hidayat
          </p>
          <hr />
          <div class="row mb-3">
            <div class="option">
              <div class="col">
                <div class="container">
                  <p>Select an Option :</p>
                  <select
                    id="datasetSelect"
                    class="form-select form-select-md mb-3"
                    aria-label="Default select example">
                    <option selected disabled>Pilih pembagian dataset :</option>
                    <option value="60-40">Training 60 % dan Test 40 %</option>
                    <option value="70-30">Training 70 % dan Test 30 %</option>
                    <option value="80-20">Training 80 % dan Test 20 %</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="col">
              <div class="container">
                <p>
                  Silahkan pilih pembagian dataset di atas untuk menampilkan
                  gambar laporan dari hasil Plot Accuracy, Plot Loss, Confusion
                  Matrix dan Classification Report untuk setiap pembagian
                  datasetnya
                </p>
              </div>
            </div>
            <hr />
          </div>
          <div class="row">
            <div class="col" id="graphTitleContainer" style="display: none">
              <div class="container">
                <div id="notFound">
                  <div class="text-center">
                    <img
                      width="150"
                      height="150"
                      src="../static/images/error-404.png"
                      alt="error" />
                  </div>
                  <p class="text-center my-5">Data Not Found</p>
                </div>
              </div>
              <div id="imageContainer" style="display: none">
                <div class="row mb-5">
                  <div class="col">
                    <div class="container">
                      <p class="text-center my-2">Grafik Plot Training</p>
                      <img
                        class="mx-auto d-block my-2"
                        width="300"
                        height="300"
                        id="trainingImage"
                        alt="" />
                    </div>
                  </div>
                  <div class="col">
                    <div class="container">
                      <p class="text-center my-2">Grafik Plot Loss</p>
                      <img
                        class="mx-auto d-block my-2"
                        width="300"
                        height="300"
                        id="validationImage"
                        alt="" />
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <hr />
            <div class="col">
              <div id="confusionMatrixContainer" style="display: none">
                <div class="row mb-5">
                  <div class="col">
                    <div class="container">
                      <p class="text-center my-2">Confusion Matrix</p>
                      <img
                        class="mx-auto d-block my-2"
                        width="300"
                        height="300"
                        id="confusionMatrix"
                        alt="" />
                    </div>
                  </div>
                  <div class="col">
                    <div class="container">
                      <div
                        id="classificationReportContainer"
                        style="display: none">
                        <div class="col">
                          <p class="text-center my-2">Classification Report</p>
                          <img
                            class="mx-auto d-block my-2"
                            width="300"
                            height="300"
                            id="classificationReports"
                            alt="" />
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Main 2 -->
    <!-- Script Predict -->
    <script>
      function predict() {
        var fileInput = document.getElementById("file-input");
        var file = fileInput.files[0];

        if (!file) {
          alert("Please select an image.");
          return;
        }

        var formData = new FormData();
        formData.append("file", file);

        fetch("/predict", {
          method: "POST",
          body: formData,
        })
          .then((response) => response.json())
          .then((data) => {
            var resultDiv = document.getElementById("result");
            resultDiv.innerHTML = `
              <p>Predicted Class : ${data.predicted_class}</p>
              <p>Confidence : ${data.confidence}</p>
            `;
          })
          .catch((error) => {
            console.error("Error:", error);
            alert("An error occurred during prediction.");
          });
      }
    </script>
    <!-- Script Predict -->

    <!-- Script Gambar-->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const datasetSelect = document.getElementById("datasetSelect");
        const imageContainer = document.getElementById("imageContainer");
        const trainingImage = document.getElementById("trainingImage");
        const validationImage = document.getElementById("validationImage");
        const confusionMatrixContainer = document.getElementById(
          "confusionMatrixContainer"
        );
        const confusionMatrix = document.getElementById("confusionMatrix");
        const classificationReportContainer = document.getElementById(
          "classificationReportContainer"
        );
        const classificationReports = document.getElementById(
          "classificationReports"
        );
        const graphTitleContainer = document.getElementById(
          "graphTitleContainer"
        );
        const dataNotFoundContainer = document.getElementById("notFound");

        datasetSelect.addEventListener("change", function () {
          const selectedOption = datasetSelect.value;

          imageContainer.style.display = "none";
          confusionMatrixContainer.style.display = "none";
          classificationReportContainer.style.display = "none";
          graphTitleContainer.style.display = "none";
          dataNotFoundContainer.style.display = "none";

          if (selectedOption === "80-20") {
            graphTitleContainer.style.display = "block";
            imageContainer.style.display = "block";
            trainingImage.src = "../static/images/80-20/PlotAccuracy.png";
            validationImage.src = "../static/images/80-20/PlotLoss.png";
            confusionMatrixContainer.style.display = "block";
            confusionMatrix.src = "../static/images/80-20/ConfusionMatrix.png";
            classificationReportContainer.style.display = "block";
            classificationReports.src =
              "../static/images/80-20/ClassificationReport.png";
          } else if (selectedOption === "60-40") {
            graphTitleContainer.style.display = "block";
            imageContainer.style.display = "block";
            trainingImage.src = "../static/images/60-40/PlotAccuracy.png";
            validationImage.src = "../static/images/60-40/PlotLoss.png";
            confusionMatrixContainer.style.display = "block";
            confusionMatrix.src = "../static/images/60-40/ConfusionMatrix.png";
            classificationReportContainer.style.display = "block";
            classificationReports.src =
              "../static/images/60-40/ClassificationReport.png";
          } else if (selectedOption === "70-30") {
            graphTitleContainer.style.display = "block";
            imageContainer.style.display = "block";
            trainingImage.src = "../static/images/70-30/PlotAccuracy.png";
            validationImage.src = "../static/images/70-30/PlotLoss.png";
            confusionMatrixContainer.style.display = "block";
            confusionMatrix.src = "../static/images/70-30/ConfusionMatrix.png";
            classificationReportContainer.style.display = "block";
            classificationReports.src =
              "../static/images/70-30/ClassificationReport.png";
          }
        });
      });
    </script>
    <!-- Script Gambar-->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"></script>
  </body>
</html>
